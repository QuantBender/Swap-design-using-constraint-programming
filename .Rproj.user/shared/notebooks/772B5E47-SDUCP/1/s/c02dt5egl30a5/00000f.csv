"0","plotDiagram <- function(rf_A, rf_B, s_A, s_B, G_B, G_A, G_bank, s_A_Bk, s_Bk_B, rf_B_Bk, rf_Bk_A, Company_A, Company_B, Bank, floating_rate) {"
"0","  # Set up an empty plot with vertical limits exactly covering the diagram."
"0","  plot(NA, NA,"
"0","       xlim = c(-4, 14), ylim = c(0, 0),"
"0","       type = ""n"", axes = FALSE, xlab = """", ylab = """", asp = 1)"
"0","  "
"0","  # Define node positions and dimensions."
"0","  # Company A: centered at (0, 0)"
"0","  A.center <- c(0, 0)"
"0","  A.left <- -1; A.right <- 1; A.top <- 0.5; A.bot <- -0.5"
"0","  "
"0","  # Bank: shifted further to the right"
"0","  Bank.center <- c(4.5, 0)"
"0","  Bank.left <- 3.5; Bank.right <- 5.5; Bank.top <- 0.5; Bank.bot <- -0.5"
"0","  "
"0","  # Company B: shifted further to the right"
"0","  B.center <- c(9, 0)"
"0","  B.left <- 8; B.right <- 10; B.top <- 0.5; B.bot <- -0.5"
"0","  "
"0","  # Draw nodes as rectangles with text inside."
"0","  rect(A.left, A.bot, A.right, A.top, col = ""lightblue"")"
"0","  text(A.center[1], A.center[2], paste(""Company "", Company_A, ""\n"", G_A, sep = """"), cex = 0.6)"
"0","  "
"0","  rect(Bank.left, Bank.bot, Bank.right, Bank.top, col = ""lightblue"")"
"0","  text(Bank.center[1], Bank.center[2], paste(""Company "", Bank, ""\n"", G_bank, sep = """"), cex = 0.6)"
"0","  "
"0","  rect(B.left, B.bot, B.right, B.top, col = ""lightblue"")"
"0","  text(B.center[1], B.center[2], paste(""Company "", Company_B, ""\n"", G_B, sep = """"), cex = 0.6)"
"0","  "
"0","  # Helper function to add an arrow with a label."
"0","  add_arrow <- function(x0, y0, x1, y1, label, label_offset = 0.1, side = ""above"") {"
"0","    arrows(x0, y0, x1, y1, code = 2, length = 0.1, lwd = 2)"
"0","    xm <- (x0 + x1) / 2"
"0","    ym <- (y0 + y1) / 2"
"0","    if (side == ""above"") {"
"0","      text(xm, ym + label_offset, label, cex = 0.6)"
"0","    } else {"
"0","      text(xm, ym - label_offset, label, cex = 0.6)"
"0","    }"
"0","  }"
"0","  "
"0","  # Draw arrows using positions computed to mimic the desired offsets."
"0","  add_arrow(A.left, 0.2, A.right - 5, 0.2, rf_A, label_offset = 0.25, side = ""above"")"
"0","  add_arrow(A.right - 5, -0.2, A.left, -0.2, paste(floating_rate, s_A, sep=""+""), label_offset = 0.25, side = ""below"")"
"0","  add_arrow(Bank.left, 0.2, A.right, 0.2, rf_Bk_A, label_offset = 0.25, side = ""above"")"
"0","  add_arrow(B.left, 0.2, Bank.right, 0.2, rf_B_Bk, label_offset = 0.25, side = ""above"")"
"0","  add_arrow(A.right, -0.2, Bank.left, -0.2, paste(floating_rate, s_A_Bk, sep=""+""), label_offset = 0.25, side = ""below"")"
"0","  add_arrow(Bank.right, -0.2, B.left, -0.2, paste(floating_rate, s_Bk_B, sep=""+""), label_offset = 0.25, side = ""below"")"
"0","  add_arrow(B.right + 2, 0.2, B.right, 0.2, rf_B, label_offset = 0.25, side = ""above"")"
"0","  add_arrow(B.right, -0.2, B.right + 2, -0.2, paste(floating_rate, s_B, sep=""+""), label_offset = 0.25, side = ""below"")"
"0","}"
