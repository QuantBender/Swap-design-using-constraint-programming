"0","plotDiagram <- function(rfDollar_A, rfDollar_B, rfYen_A, rfYen_B, G_B, G_A, G_bank, rfYen_Bk_A, rf_Dollar_Bk_B, rf_Dollar_A_Bk, rf_Yen_B_Bk, Company_X, Company_Y, Bank, currency1, currency2) {"
"0","  # Set up an empty plot with vertical limits exactly covering the diagram."
"0","  plot(NA, NA,"
"0","       xlim = c(-4, 14), ylim = c(0, 0),"
"0","       type = ""n"", axes = FALSE, xlab = """", ylab = """", asp = 1)"
"0","  "
"0","  # Define node positions and dimensions."
"0","  # Company X: centered at (0, 0)"
"0","  X.center <- c(0, 0)"
"0","  X.left <- -1; X.right <- 1; X.top <- 0.5; X.bot <- -0.5"
"0","  "
"0","  # Bank: shifted further to the right"
"0","  Bank.center <- c(4.5, 0)"
"0","  Bank.left <- 3.5; Bank.right <- 5.5; Bank.top <- 0.5; Bank.bot <- -0.5"
"0","  "
"0","  # Company Y: shifted further to the right"
"0","  Y.center <- c(9, 0)"
"0","  Y.left <- 8; Y.right <- 10; Y.top <- 0.5; Y.bot <- -0.5"
"0","  "
"0","  # Draw nodes as rectangles with text inside."
"0","  rect(X.left, X.bot, X.right, X.top, col = ""lightblue"")"
"0","  text(X.center[1], X.center[2], paste(""Company "", Company_X, ""\n"", G_A, sep = """"), cex = 0.6)"
"0","  "
"0","  rect(Bank.left, Bank.bot, Bank.right, Bank.top, col = ""lightblue"")"
"0","  text(Bank.center[1], Bank.center[2], paste(""Company "", Bank, ""\n"", G_bank, sep = """"), cex = 0.6)"
"0","  "
"0","  rect(Y.left, Y.bot, Y.right, Y.top, col = ""lightblue"")"
"0","  text(Y.center[1], Y.center[2], paste(""Company "", Company_Y, ""\n"", G_B, sep = """"), cex = 0.6)"
"0","  "
"0","  # Helper function to add an arrow with"
"0","  add_arrow <- function(x0, y0, x1, y1, label, label_offset = 0.1, side = ""above"") {"
"0","    arrows(x0, y0, x1, y1, code = 2, length = 0.1, lwd = 2)"
"0","    xm <- (x0 + x1) / 2"
"0","    ym <- (y0 + y1) / 2"
"0","    if (side == ""above"") {"
"0","      text(xm, ym + label_offset, label, cex = 0.6)"
"0","    } else {"
"0","      text(xm, ym - label_offset, label, cex = 0.6)"
"0","    }"
"0","  }"
"0","  "
"0","  # Draw arrows using positions computed to mimic the desired offsets."
"0","  add_arrow(X.left, 0.2, X.right - 5, 0.2, paste(currency1, rfDollar_A, sep="" : ""), label_offset = 0.25, side = ""above"")"
"0","  add_arrow(X.right - 5, -0.2, X.left, -0.2, paste(currency2, rfYen_A, sep="" : ""), label_offset = 0.25, side = ""below"")"
"0","  add_arrow(Bank.left, 0.2, X.right, 0.2, rf_Dollar_A_Bk, label_offset = 0.25, side = ""above"")"
"0","  add_arrow(Y.left, 0.2, Bank.right, 0.2, rf_Dollar_Bk_B, label_offset = 0.25, side = ""above"")"
"0","  add_arrow(X.right, -0.2, Bank.left, -0.2, rfYen_Bk_A, label_offset = 0.25, side = ""below"")"
"0","  add_arrow(Bank.right, -0.2, Y.left, -0.2, rf_Yen_B_Bk, label_offset = 0.25, side = ""below"")"
"0","  add_arrow(Y.right + 2, 0.2, Y.right, 0.2, rfDollar_B, label_offset = 0.25, side = ""above"")"
"0","  add_arrow(Y.right, -0.2, Y.right + 2, -0.2, rfYen_B, label_offset = 0.25, side = ""below"")"
"0","}"
